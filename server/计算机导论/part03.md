# 操作系统

## 引言

### 操作系统的目的：

1. 更有效地使用硬件；
2. 容易地使用资源。

### 自举过程

1. 将自举程序存储在 ROM，通电后 CPU 的 PC 被设置为自举程序的第一条指令；
2. 自举程序的指责是将磁盘中的操作系统装入 RAM 内存。

## 演化

## 组成部分

内存管理器、进程管理器、设备管理器、文件管理器 + 用户界面

### 内存管理

#### 单道程序

#### 多道程序

同一时刻可以装入多个程序且能同时执行，CPU 轮流为其服务。

非交换：分区、分页；交换：请求分页、请求分段

##### 分区调度

连续内存 + 完整程序

##### 分页调度

1. 程序分页，内存分为帧。
2. 不连续帧 + 完整程序

##### 请求分页调度

1. 不连续帧 + 不完整程序
2. 作业运行中，要访问的分页不在内存，通过调页功能将其调入。

##### 请求分段调度

1. 程序分为主程序和子程序，划分为段。

##### 请求分页和分段调度

#### 虚拟内存

### 进程管理

#### 程序、作业、进程。

#### 状态图

1. 保持状态：一个程序被操作系统选定，成为作业后
2. 就绪状态：作业被调入内存，转为进程
3. 运行状态：CPU 运行进程

运行三种情况：

- CPU 运行直至它需要资源：等待状态
- 进程耗尽分配的时间片：就绪状态
- 进程终止：终止状态

#### 调度器

将作业或进程从一个状态改变另一个状态，进程管理器使用了两个调度器：作业调度器和进程调度器

1. 作业调度器：将作业从保持状态转为就绪状态，或将进程从运行状态转为终止状态，即**创建和终止进程**。
2. 进程调度器：就绪、等待和运行状态之间切换。

#### 队列

很多作业和进程竞争计算机资源，进程管理器使用队列存储管理有作业或进程信息的作业**控制块**或进程控制块。调度策略：FIFO、最短长度优先、最高优先级

1. 作业队列：等待进入内存
2. 就绪队列：等待 CPU
3. I/O 队列：等待 I/O 设备进程

#### 进程同步

资源被多个进程占用会出现：死锁和饿死。

##### 死锁

操作系统没有对进程的资源进行限制时。

发生死锁的 4 个必要条件：

1. 互斥：一个资源只能被一个进程占有
2. 资源占有
3. 抢先：不允许操作系统临时重新分配资源
4. 循环等待：所有进程和资源都在一个循环里

##### 饿死

操作系统对进程分配资源限制太多。

> 哲学家问题

### 设备管理器

计算机系统中，输入/输出设备存在数量和速度的限制。

设备管理器的功能：

1. 不停地监视输入/输出设备，保证设备正常运行。知道设备何时完成一个进程的服务，和为队列的下一进程服务；
2. 为每一个输入/输出设备维护一个或多个队列；
3. 控制访问输入/输出设备的策略。

### 文件管理

## 主流操作系统

### Unix

特点：可移植，具有强大的命令行工具，设备无关性。

Unix 是多用户、多道程序、可移植的操作系统，它被设计用来方便编程、文本处理、通信。

#### Unix 的结构

1. 内核
2. 命令解释器：对用户最可见
3. 一组标准工具：文本编辑器、搜索程序、排序程序
4. 应用程序

### Linux

1. 组成：内核、系统库、系统工具
2. 网络功能：支持标准因特网协议。支持三层：套接字接口、协议驱动、网络设备驱动
3. 安全：身份验证、访问控制

### Windows

1. 设计目标：可扩展、可移植、可靠、兼容和性能
2. 体系结构：硬件抽象层HAL、内核、执行者（6个子系统）、环境子系统